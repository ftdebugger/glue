!function(){var e=function(){var e=0;return function(){return e++}}(),t=function(){var t=function(t){this.id=e(),this.nexuses={},this.instances={},this.parent=t};return t.fn=t.prototype,t.fn.getInstance=function(){var e=new t(this);return this.instances[e.id]=e,e},t.fn.removeInstance=function(e){delete this.instances[e.id]},t.fn.destroy=function(){for(var e in this.nexuses)if(this.nexuses.hasOwnProperty(e)){var t=this.nexuses[e];t.destroy()}for(var n in this.instances)this.instances.hasOwnProperty(n)&&this.instances[n].destroy();this.parent&&this.parent.removeInstance(this)},t.fn.getObjectId=function(t){var n="__glue_object_id";return t[n]||(t[n]=e()),t[n]},t.fn.callback=function(e,t){var n;typeof e=="function"?n=e:t&&typeof t=="object"&&typeof t[e]=="function"?n=t[e]:typeof window[e]=="function"&&(n=window[e]);if(!n)throw new Error("accessor must be valid callback");return t&&typeof t=="object"&&(n=n.bind(t)),n},t}();(function(t){var n=function(){this.id=e(),this.callback=null};t.fn.Nexus=n;var r=n.prototype;r.setCallback=function(e,t){return e&&(this.callback=this.instance.callback(e,t)),this},r.once=function(){var e=this.callback,t=this;return this.callback=function(){e.apply(this,[].slice.call(arguments)),t.destroy()},this},r.async=function(e){var t=this.callback;return this.callback=function(){setTimeout(function(){t.apply(this,[].slice.call(arguments))},e||10)},this},r.invoke=function(){this.invokeContext(this)},r.invokeContext=function(e){try{this.callback.call(e,this)}catch(t){console.error(t)}},r.destroy=function(){delete this.instance.nexuses[this.id],this.listener&&this.listener.removeNexus(this.id)},t.fn.getNexus=function(){var e=new n;return e.instance=this,this.nexuses[e.id]=e,e}})(t),function(e){var t="__glueListener",n=function(e,t){this.method=e,this.object=t,this.nexuses={}};e.fn.Listener=n;var r=n.prototype;r.replace=function(){var e=this,n=this.object[this.method];this.object[this.method]=function(){var t=Array.prototype.slice.call(arguments),r,i=this;return r=n.apply(i,t),e.invoke(t,i),r},this.object[this.method][t]=this},r.invoke=function(e,t){var n=this.nexuses;for(var r in n)n.hasOwnProperty(r)&&(n[r].args=e,n[r].invokeContext(t))},r.addObserver=function(e){this.nexuses[e.id]=e,e.listener=this},r.removeNexus=function(e){delete this.nexuses[e]},e.fn.getListener=function(e,r){if(e in r){var i=r[e];if(i[t]&&r.hasOwnProperty(e))return i[t];var s=new n(e,r);return s.replace(),s}throw new Error("Method not exists")}}(t),function(e){e.fn.observer=function(e,t,n,r,i){if(e in t){typeof n!="boolean"&&(i=r,r=n);var s=this.getNexus(),o=this.getListener(e,t);return o.addObserver(s),r&&s.setCallback(r,i),s}throw new Error("Method "+e+" not exists")}}(t);var n=new t;n.fn=t.fn,typeof this.define!="undefined"?this.define("glue",function(){return n}):this.glue=n}();