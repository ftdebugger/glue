!function(){var e=function(e,t){var n=function(){var e=function(){},t=function(){};t.prototype=Array.prototype,e.prototype=new t;var n=e.prototype;return n.destroy=function(){this.forEach(function(e,t){e.destroy(),this[t]=undefined},this),this.length=0},n.destroyWidget=function(e){var t=-1;for(var n=0;n<this.length;n++)t>=0?this[t++]=this[n]:this[n]==e&&(t=n);t>=0&&this.length--,e.destroy()},n.push=function(e){return[].push.call(this,e),e},n.refresh=function(){for(var e=0;e<this.length;e++)this[e].refresh()},e}(),r=function(e){var n=function(t,n){this.dict={},this.removeRest=!0,this.constructor=t,this.widgetConfig=!1,this.autoReorder=!1,e.extend(this,n||{})},r=n.prototype;return r.apply=function(e,n){if(this.removeRest)var r=this._keys();var i=[];e.forEach(function(e){var r=t.getObjectId(e);i.push(r),this.dict[r]?this.autoReorder&&n.append(this.dict[r].render()):(this.dict[r]=this.factory(e),n.append(this.dict[r].render()))},this),this.removeRest&&(r=this._diff(r,i),r.forEach(this.destroyWidget,this))},r._keys=function(){var e=this.dict,t=[];for(var n in t)t.hasOwnProperty(n)&&t.push(n);return t},r._diff=function(e,t){var n=[];return e.forEach(function(e){for(var r=0;r<t.length;r++)if(t[r]==e)return;n.push(e)}),n},r.factory=function(t,n){var r=this._getWidgetConfig();n=n||{},n.model=t,e.extend(n,r);if(typeof this.constructor!="function")throw new Error("Constructor must be function");return new this.constructor(n)},r.destroyWidget=function(e){this.dict[e].destroy(),delete this.dict[e]},r._getWidgetConfig=function(){if(typeof this.widgetConfig=="function")var e=e();else e=this.widgetConfig;return typeof e!="object"&&(e={}),e},r.destroy=function(){this.forEach(function(e){e.destroy()}),this.dict={}},r.forEach=function(e,t){t&&(e=e.bind(t));for(var n in this.dict)this.dict.hasOwnProperty(n)&&e(this.dict[n])},n},i=!function(){var i;t.fn.createWidget=function(e){var t=function(t){i.call(this,t),e&&e.call(this,t)},n=function(){};return n.prototype=i.prototype,t.prototype=new n,t},i=t.fn.Widget=function(n){e.extend(this,n||{}),this.glue=t.getInstance(),this._widgetLists=[],this._widgetDicts=[],this._widgets=this.widgetList(),this._findCache={},this._leaveDom=!1};var s=i.prototype;return s.render=function(){throw new Error("You must implement render method")},s.refresh=function(){},s.destroy=function(){!this._leaveDom&&this.dom&&this.dom.remove(),this.glue&&this.glue.clear(),this._widgetLists.length&&this._widgetLists.forEach(function(e){e.destroy()}),this._widgetDicts.length&&this._widgetDicts.forEach(function(e){e.destroy()})},s._initEvents=function(){},s.leaveDomAfterDestroy=function(){this._leaveDom=!0},s.removeDomAfterDestroy=function(){this._leaveDom=!1},s.widgetList=function(){var e=new n;return this._widgetLists.push(e),e},s.widgetDict=function(e,t){if(typeof e!="function")throw new Error("Constructor must be function");var n=new r(e,t);return this._widgetDicts.push(n),n},s.addWidget=function(e){return this._widgets.push(e),e},s.destroyWidget=function(e){typeof e=="string"?this[e]&&(this._widgets.destroyWidget(this[e]),delete this[e]):this._widgets.destroyWidget(e)},s.getProto=function(){return t.Widget.prototype},s.observer=function(e,t,n){return typeof e=="string"?this.glue.observer(e,this.model,t||this.refresh,n||this):e.map(function(e){return this.observer(e,t,n)},this)},s.show=function(){this.dom.show()},s.hide=function(){this.dom.hide()},s.toggle=function(){this.dom.toggle()},s.find=function(e,t){return t?this.dom.find(e):(this._findCache[e]||(this._findCache[e]=this.dom.find(e)),this._findCache[e])},s.filter=function(e){return this.dom.filter(e)},s.click=function(e,t,n){return this.bind("click",e,t,n)},s.bind=function(e,t,n,r){var i=this;typeof t=="function"&&(r=n,n=t,t=null);if(t)var s=this.dom.find(t);else s=this.dom;s.bind(e,function(e){return e.preventDefault(),n.call(r?r:i,e)})},s.getTemplate=function(t){return e("#template-"+t).html().trim()},t.fn.createWidget}();return i};typeof this.define!="undefined"?this.define("glue/widget",["jquery","glue"],e):e(this.jQuery,this.glue)}();