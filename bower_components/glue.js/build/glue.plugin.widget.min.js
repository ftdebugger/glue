!function(){var a=function(a,b){var c=function(){var a=function(){},b=function(){};b.prototype=Array.prototype,a.prototype=new b;var c=a.prototype;return c.destroy=function(){this.forEach(function(a,b){a.destroy(),this[b]=void 0},this),this.length=0},c.destroyWidget=function(a){for(var b=-1,c=0;c<this.length;c++)b>=0?this[b++]=this[c]:this[c]==a&&(b=c);b>=0&&this.length--,a.destroy()},c.push=function(a){return[].push.call(this,a),a},c.refresh=function(){for(var a=0;a<this.length;a++)this[a].refresh()},a}(),d=function(){var c=function(b,c){this.dict={},this.removeRest=!0,this.constructor=b,this.widgetConfig=!1,this.autoReorder=!1,a.extend(this,c||{})},d=c.prototype;return d.apply=function(a,c){if(this.removeRest)var d=this._keys();var e=[];a.forEach(function(a){var d=b.getObjectId(a);e.push(d),this.dict[d]?this.autoReorder&&c.append(this.dict[d].render()):(this.dict[d]=this.factory(a),c.append(this.dict[d].render()))},this),this.removeRest&&(d=this._diff(d,e),d.forEach(this.destroyWidget,this))},d._keys=function(){var a=this.dict,b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},d._diff=function(a,b){var c=[];return a.forEach(function(a){for(var d=0;d<b.length;d++)if(b[d]==a)return;c.push(a)}),c},d.factory=function(b,c){var d=this._getWidgetConfig();if(c=c||{},c.model=b,a.extend(c,d),"function"!=typeof this.constructor)throw new Error("Constructor must be function");return new this.constructor(c)},d.destroyWidget=function(a){this.dict[a].destroy(),delete this.dict[a]},d._getWidgetConfig=function(){if("function"==typeof this.widgetConfig)var a=this.widgetConfig();else a=this.widgetConfig;return"object"!=typeof a&&(a={}),a},d.destroy=function(){this.forEach(function(a){a.destroy()}),this.dict={}},d.forEach=function(a,b){b&&(a=a.bind(b));for(var c in this.dict)this.dict.hasOwnProperty(c)&&a(this.dict[c])},c}(),e=function(){var e;b.fn.createWidget=function(b){var c=function(a){e.call(this,a),b&&b.call(this,a)},d=function(){};return d.prototype=e.prototype,c.prototype=new d,c.extend=function(b){return a.extend(c.prototype,b),c},c},e=b.fn.Widget=function(c){a.extend(this,c||{}),this.glue=b.getInstance(),this._widgetLists=[],this._widgetDicts=[],this._widgets=this.widgetList(),this._findCache={},this._leaveDom=!1};var f=e.prototype;return f.render=function(){throw new Error("You must implement render method")},f.refresh=function(){},f.destroy=function(){!this._leaveDom&&this.dom&&this.dom.remove(),this.glue&&this.glue.destroy(),this._widgetLists.length&&this._widgetLists.forEach(function(a){a.destroy()}),this._widgetDicts.length&&this._widgetDicts.forEach(function(a){a.destroy()})},f._initEvents=function(){},f.leaveDomAfterDestroy=function(){this._leaveDom=!0},f.removeDomAfterDestroy=function(){this._leaveDom=!1},f.widgetList=function(){var a=new c;return this._widgetLists.push(a),a},f.widgetDict=function(a,b){if("function"!=typeof a)throw new Error("Constructor must be function");var c=new d(a,b);return this._widgetDicts.push(c),c},f.addWidget=function(a){return this._widgets.push(a),a},f.destroyWidget=function(a){"string"==typeof a?this[a]&&(this._widgets.destroyWidget(this[a]),delete this[a]):this._widgets.destroyWidget(a)},f.getProto=function(){return b.Widget.prototype},f.observer=function(a,b,c){return"string"==typeof a?this.glue.observer(a,this.model,b||this.refresh,c||this):a.map(function(a){return this.observer(a,b,c)},this)},f.show=function(){this.dom.show()},f.hide=function(){this.dom.hide()},f.toggle=function(){this.dom.toggle()},f.find=function(a,b){return b?this.dom.find(a):(this._findCache[a]||(this._findCache[a]=this.dom.find(a)),this._findCache[a])},f.filter=function(a){return this.dom.filter(a)},f.click=function(a,b,c){return this.on("click",a,b,c)},f.on=f.bind=function(b,c,d,e){var f=this;if("function"==typeof c&&(e=d,d=c,c=null),c)var g=this.dom.find(c);else g=this.dom;g.on(b,function(b){return b.preventDefault(),d.call(e?e:f,b,a(b.target))})},f.input=function(a,b,c){if("function"!=typeof b)throw new Error("Unsupported callback '"+typeof b+"'");this.on("change",a,function(a,d){var e;e=d.is("[type=checkbox]")?d.is(":checked"):d.val(),b.call(c||this.model,e)})},f.getTemplate=function(b){var c=a("#template-"+b);if(!c.size())throw new Error('Template "'+b+'" not found via "#template-'+b+'"');var d=c.html();if(!d)throw new Error('Empty template "'+b+'"');return d.trim()},f.renderTemplate=function(b,c){return c=c||this.model,a(this.getTemplate(b).replace(/{([^{}]*)}/g,function(a,b){var d=c[b];return"string"==typeof d||"number"==typeof d?d:a}))},b.fn.createWidget}();return e};"undefined"!=typeof this.define?this.define("glue/widget",["jquery","glue"],a):a(this.jQuery,this.glue)}();